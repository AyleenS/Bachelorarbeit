\chapter{Verfeinerung, Error- und Ruhe-Freiheit}

\section{Präkongruenz für Ruhe}

In diesem Kapitel wird es nicht mehr nur um die Erreichbarkeit von
Error-Zuständen gehen, sondern auch um die Erreichbarkeit von
Ruhe-Zuständen. Es wird dabei ein ähnlich vorgehen wie im letzten Kapitel
angewandt, jedoch wird~\cite{Chilton2013} als Quelle verwendet. Darin werden ähnliche
Konzepte beschrieben, jedoch aus Sicht der Traces. Es werden dort zudem
gleichzeitig auch noch Traces mit Divergenz betrachtet. Diese Eigenschaft wird
hier zunächst nicht betrachtet.\\
Die Zustände, die keine Outputs und keine Transitionsmöglichkeit für
eine interne Aktion haben werden, als eine Art Verklemmung angesehen, da sie
ohne einen Input von einem Kommunikationspartner den Zustand nicht mehr
verlassen können.

\begin{Def}[Ruhe]
  Ein \emph{Ruhe-Zustand} ist ein Zustand in einem \EIO{}, der keine
  Outputs und kein $\tau$ zulässt.\\
  Somit ist die Menge der Ruhe-Zustände in einem \EIO{} wie folgt formal
  definiert: $Qui:=\big\{q\in Q\mid \forall \alpha\in (O\cup \{\tau\}): q
  \overset{\alpha}{\not{\hspace{-0.1cm}\rightarrow}}\big\}$.
\end{Def}

Für die Erreichbarkeit wird wie im letzten Kapitel wieder der
optimistischen Ansatz der lokalen Erreichbarkeit für die Error-Zustände
verwendet. Ruhe ist kein unabwendbaren Fehler, sondern kann durch einen Input
repariert werden. Somit ist ein Ruhe-Zustand als nicht so \glqq{}schlimmer
Fehler\grqq{} anzusehen wie ein Error. Somit ist ein Ruhe-Zustand ebenso wie
ein Error-Zustand erreichbar, sobald er durch Outputs und $\tau$s erreicht
werden kann, jedoch ist nicht jede beliebige Fortsetzung eines Traces, der die
Eigenschaft erfüllt ein Ruhe-Trace.

\begin{Def}[error- und ruhe-freie Kommunikation]
  Zwei \EIO{}s $S_1$ und $S_2$ \emph{kommunizieren error- und ruhe-frei}, wenn
  in ihrer Parallelkomposition $S_1\| S_2$ keine Errors und keine Ruhe-Zustände
  lokal erreichbar sind.
\end{Def}

\begin{Def}[Ruhe-Verfeinerungs-Basisrelation]
  \label{DefQuiBasisrel}
  Für \EIO{}s $S_1$ und $S_2$ mit der gleichen Signatur wird
  $S_1\QBRel S_2$ geschrieben, wenn ein Error oder Ruhe-Zustand in $S_1$ nur
  dann lokal erreichbar ist, wenn ein solcher auch in $S_2$ lokal erreichbar
  ist. Diese \emph{Basisrelation} stellt eine \emph{Verfeinerung} bezüglich
  \emph{Errors} und \emph{Ruhe-Zustände} dar.\\
  \QCRel{} bezeichnet die \emph{vollständig abstrakte Präkongruenz} von
  \QBRel{} bezüglich $\cdot\|\cdot$.
\end{Def}

Um eine genauer Auseinandersetzung mit den Präkongruenzen zu ermöglichen,
benötigt man wie im letzten Kapitel die Definition von Traces auf der Struktur.
Dadurch erhält man die Möglichkeit die gröbste Präkongruenz charakterisieren zu
können.\\
Wie bereits oben erwähnt, sind Ruhe-Zustände reparierbare Fehler im Gegensatz
zu Errors. Somit werden keine gekürzten Ruhetraces benötigt, bei denen die
\prune{}-Funktion zur Anwendung käme, da auch keine beliebigen Verlängerungen
davon benötigt werden.

\begin{Def}[Ruhetraces]
  \label{DefRuhetraces}
  Sei $S$ ein \EIO{} und definiere:
  \begin{itemize}
    \item \emph{strikte Ruhetraces}: $\StQT{}(S) := \{w\in\Sigma ^*\mid q_0
      \overset{w}{\Rightarrow} q\in Qui\}$.
  \end{itemize}
\end{Def}

Es wird nur eine Semantik für die Ruhe definiert, die Error-Semantik wird aus
dem letzten Kapitel übernommen. Somit gelten für \ET{} und \EL{} die
Definitionen aus dem letzten Kapitel.

\begin{Def}[Ruhe-Semantik]
  \label{DefQTQL}
  Sei $S$ ein \EIO{}.
  \begin{itemize}
    \item Die Menge der \emph{error-gefluteten Ruhetraces} von $S$ ist
      $\QT{}(S) := \StQT{}(S)\cup \ET{}(S)$.
  \end{itemize}
  Für zwei \EIO{}s $S_1, S_2$ mit der gleichen Signatur wird
  $S_1\QRel S_2$ geschrieben, wenn $S_1\ERel S_2$ und $\QT{}(S_1)\subseteq
  \QT{}(S_2)$ gilt.
\end{Def}

Für die Menge der error-gefluteten Ruhetraces \QT{} wurde eine Informationsvermischung
mit den Errortraces vorgenommen wie beim Fluten der Sprache \EL{}. Da jedoch
durch die Ruhetraces keine neuen Traces entstehen, die nicht bereits in der
gefluteten Sprache \EL{} enthalten wären, würde eine neue Flutung nichts
ändern. Es wird also durch die Relation \QRel{} nur die
bereits existierende Präkongruenz \ERel{} eingeschränkt.\\
Das folgende Lemma soll explizit festhalten, wie Ruhezustände sich unter der
Parallelkomposition verhalten. Dies ist vor allem in dem danach folgenden Satz
relevant.

\begin{lem}[Ruhe-Zustände unter Parallelkomposition]
  \label{lemRuheParallelkomp}
  ~
  \begin{enumerate}
    \item Ein Zustand $(q_1,q_2)$ aus der Parallelkomposition $S_{12}=S_1\|S_2$
      ist ruhig, wenn es auch die Zustände $q_1$ und $q_2$ in $S_1$ bzw.\ $S_2$
      sind.
    \item Wenn der Zustand $(q_1,q_2)$ ruhig ist und nicht in $E_{12}$
      enthalten ist, dann sind auch die auf die Teilsysteme projizierten
      Zustände $q_1$ und $q_2$ ruhig.
  \end{enumerate}
\end{lem}

\begin{proof}
  ~
  \begin{enumerate}
    \item \hspace{-0.2cm}:
  \end{enumerate}
  \vspace{-0.3cm}
  Da $q_1\in Qui_1$ und $q_2\in Qui_2$ gilt, haben
  diese beiden Zustände jeweils höchstens die Möglichkeiten Transitionen
  auszuführen, die mit Inputs beschriftet sind. Jedoch keine Möglichkeiten für
  Outputs oder $\tau$s. Der Zustand, der durch Parallelkomposition aus diesen
  beiden Zuständen entsteht hat nur die Transitionsmöglichkeiten dieser
  Zustände die parallel ausgeführt werden. Es gibt somit drei unterschiedliche
  Möglichkeiten:
  \begin{itemize}
    \item Fall 1 ($a\in I_i\backslash Synch(S_1,S_2)\wedge q_i
      \overset{a}{\rightarrow}$ für ein $i\in \{1,2\}$): Da $a$ ein
      Input ist, der nicht in der Menge der synchronisierten Aktionen enthalten
      ist, wird dieser unabhängig ausgeführt, somit hat
      $(q_1,q_2)$ ebenfalls die Möglichkeit eine Transition mit $a$ als Input
      auszuführen.
    \item Fall 2 ($a\in I_1\cap I_2\wedge q_i \overset{a}{\rightarrow}$ für
      beide $i\in \{1,2\}$): Da beide Zustände den gleichen Input ausführen
      können, der zu synchronisieren ist, gilt somit $(q_1,q_2)
      \overset{a}{\rightarrow}$. Wobei $a\in I_{12}$ gilt.
    \item Fall 3 ($a\in I_i\cap Synch(S_1,S_2)\wedge q_i
      \overset{a}{\rightarrow}$ für ein $i\in \{1,2\}$): Hier handelt es sich
      um eine Transition, die für $(q_1,q_2)$ nicht ausführbar ist, da es keine
      passende Transition für das andere System gibt, mit dem diese Aktion
      synchronisiert werden könnte. Da es sich hier jedoch um den Input der zu
      synchronisierenden Aktion handelt, entsteht daraus auch kein
      neu Fehler, sondern einfach nur eine Transition, die nicht
      genommen werden kann, weil der passende Output bzw.\ Input im anderen
      System nicht vorhanden ist.
  \end{itemize}
  Dies sind alle Fälle, die auftreten können für die Parallelkomposition der
  Transitionsmöglichkeiten. Bei keinen dieser Möglichkeiten ist ein Output oder
  ein $\tau$ entstanden und somit hat der Zustand $(q_1,q_2)$ auch keine
  Möglichkeiten solche Transitionen auszuführen. Daraus folgt also, dass
  $(q_1,q_2)\in Qui_{12}$ gilt.

  2.:\\
  Es gilt $(q_1,q_2)\in Qui_{12}\backslash E_{12}$, somit hat
  dieser Zustand maximal die Möglichkeit Transitionen für Inputs auszuführen.
  Diese Transitionen für Inputs können nur aus Inputs, die nicht in der Menge
  der synchronisierten Aktionen enthalten sind oder aus der Synchronisation
  von zwei Inputs aus der Menge $I_1\cap I_2$ enstehen. Durch die
  Parallelkomposition von Outputs mit anderen Aktionen können keine Inputs
  entstehen und in der hier verwendeten Definition der Parallelkomposition auch
  keine $\tau$s. Outputs, die nicht in der Menge $Synch(S_1,S_2)$ enthalten sind,
  würden als Outputs des zusammengesetzten Zustandes übernommen werden und
  können somit weder bei $q_1$ noch bei $q_2$ vorhanden sein. Falls jedoch
  $(q_1,q_2)\in E_{12}$ zulassen wäre, wäre es möglich, dass einer der beiden
  Zustände $q_i$ eine Transitionsmöglichkeit für einen Output hat, der aufgrund
  eines fehlenden Inputs des anderen Zustandes nicht synchronisiert werden kann
  und somit ein neuer Error entsteht. Dieser Fall wird jedoch durch die
  zusätzliche Einschränkung ausgeschlossen. Falls einer der beiden Zustände
  eine Transitionsmöglichkeit für ein $\tau$ gehabt hätte, müsste dies auch der
  zusammengesetzte Zustand haben und könnte somit nach Definition
  nicht ruhig sein. Es folgt also, dass $q_1$ und $q_2$ ebenso nur
  Transitionen mit Inputs ausführen können. Es gilt also $q_1\in Qui_1$ und
  $q_2\in Qui_2$.
\end{proof}

In dem folgenden Satz sind Punkt 1.\ und 3.\ nur zur Vollständigkeit aufgeführt.
Sie entsprechen Punkt 1.\ und 2.\ aus Satz~\ref{satzErrorSemanik}.

\begin{satz}[Error- und Ruhe-Semantik für Parallelkompositonen]
  \label{satzQuiSemantik}
  Für zwei komponierbare \EIO{}s $S_1, S_2$ und ihre Komposition $S_{12} =
  S_1\|S_2$ gilt:
  \begin{enumerate}
    \item $\ET{}_{12} = \cont{}(\prune{}((\ET{}_1\|\EL{}_2)\cup
      (\EL{}_1\|\ET{}_2)))$,
    \item $\QT{}_{12} = (\QT{}_1\|\QT{}_2)\cup \ET{}_{12}$,
    \item $\EL{}_{12} = (\EL{}_1\|\EL{}_2)\cup \ET{}_{12}$.
  \end{enumerate}
\end{satz}

\begin{proof}
  Es wird nur der 2. Punkt bewiesen.

  \glqq $\subseteq$\grqq :\\
  Hier muss unterscheiden werden ob ein $w\in\StQT{}_{12}\backslash \ET{}_{12}$
  oder ein $w\in \ET{}_{12}$ betrachtet wird. Im zweiten Fall ist das
  $w$ in der rechten Seite enthalten. Somit wird ab jetzt ein $w\in
  \StQT{}_{12}\backslash \ET{}_{12}$ betrachtet und dessen Zugehörigkeit zur
  rechten Menge versucht zu zeigen. Aufgrund von
  Definition~\ref{DefRuhetraces} weiß man, dass $(q_{01},q_{02})
  \overset{w}{\Rightarrow} (q_1,q_2)$ gilt mit $(q_1,q_2)\in Qui_{12}$. Durch
  Projektion erhält man $q_{01} \overset{w_1}{\Rightarrow} q_1$ und $q_{02}
  \overset{w_2}{\Rightarrow} q_2$ mit $w\in w_1\|w_2$. Aus $(q_1,q_2)\in
  Qui_{12}$ kann mit Punkt 2.\ von Lemma~\ref{lemRuheParallelkomp} gefolgert
  werden, dass bereits $q_1\in Qui_1$ und $q_2\in Qui_2$ gilt. Somit gilt
  $w_1\in \StQT{}_1\subseteq \QT{}_1$ und $w_2\in \StQT{}_2\subseteq \QT{}_2$.
  Daraus folgt dann $w\in \QT{}_1\|\QT{}_2$ und somit ist $w$ in der rechten
  Seiten der Gleichung enthalten.

  \glqq $\supseteq$\grqq :\\
  Es muss wieder danach unterschieden werden aus welcher Menge das betrachtete
  Element stammt. Falls $w\in \ET{}_{12}$ gilt, so kann die
  Zugehörigkeit zur linken Seite direkt folgert werden. Somit wird für den
  weiteren Beweis dieser Inklusionsrichtung ein Element $w\in \QT{}_1\|\QT{}_2$
  betrachtet und gezeigt, dass es in der linken Menge enthalten ist. Da
  $\QT{}_i = \StQT{}_i\cup \ET{}_i$ gilt, existieren für $w_1$ und $w_2$ mit
  $w\in w_1\| w_2$ unterschiedliche Möglichkeiten:
  \begin{itemize}
    \item Fall 1 ($w_1\in \ET{}_1\vee w_2\in \ET{}_2$): \OBdA{} gilt
      $w_1\in \ET{}_1$. Nun kann $w_2\in \StQT{}_2\subseteq L_2$ gelten
      oder $w_2\in \ET{}_2$ und somit gilt auf jeden Fall $w_2\in
      \EL{}_2$. Daraus kann dann mit dem ersten Punkt von
      Satz~\ref{satzErrorSemanik} gefolgert werden, dass $w\in \ET{}_{12}$ gilt
      und somit $w$ in der linken Seite der Gleichung enthalten ist.
    \item Fall 2 ($w_1\in \StQT{}_1\backslash\ET{}_1\wedge w_2\in
      \StQT{}_2\backslash\ET{}_2$): Es gilt in diesem Fall $q_{01}
      \overset{w_1}{\Rightarrow} q_1\in Qui_1$ und $q_{02}
      \overset{w_2}{\Rightarrow} q_2\in Qui_2$. Da $q_1$ und $q_2$ in der
      Ruhe-Menge enthalten sind, ist auch der Zustand, der aus ihnen
      zusammengesetzt ist, in der Parallelkomposition ruhig und lässt keine
      $\tau$-Transitionen zu, wie bereits in Punkt 1.\ von
      Lemma~\ref{lemRuheParallelkomp} gezeigt. Es gilt also für die Komposition
      $(q_{01},q_{02}) \overset{w}{\Rightarrow} (q_1,q_2)\in Qui_{12}$ und
      dadurch ist $w$ in der linken Seite der Gleichung enthalten, da $w\in
      \StQT{}_{12}\subseteq \QT{}_{12}$ gilt.
  \end{itemize}
\end{proof}

Die folgende Proposition ist eine direkte Folgerung aus dem letzten Satz.
Jedoch ist es eine wichtige Feststellung für den weiteren Verlauf die gröbste
Präkongruenz charakterisieren zu wollen.

\begin{prop}[Ruhe-Präkongruenz]
  \label{propQuiPrae}
  \QRel{} ist eine Präkongruenz bezüglich $\cdot\|\cdot$.
\end{prop}

\begin{proof}
  Es muss gezeigt werden: Wenn $S_1\QRel S_2$ gilt, so auch
  $S_3\|S_1\QRel S_3\|S_2$ für jedes $S_3$. D.h.\ es ist zu zeigen, dass aus
  $S_1\ERel S_2$ und $\QT{}_1\subseteq \QT{}_2$, $S_{31}\ERel S_{32}$ und
  $\QT{}_{31}\subseteq \QT{}_{32}$ folgt. Dies ergibt sich wie im Beweis
  zu Proposition~\ref{propPraekongruenz} aus der Monotonie von $\cdot\|\cdot$
  auf Sprachen wie folgt:
  \begin{itemize}
    \item $\begin{aligned}[t]
        S_{31} \overset{\mathrm{Proposition}
        ~\ref{propPraekongruenz}}{\overset{\mathrm{und}}{\overset{S_1\ERel
    S_2}{\ERel}}} S_{32},
    \end{aligned}$
    \item $\begin{aligned}[t]
        \QT{}_{31} &\overset{\ref{satzQuiSemantik}~2.}{=}
        (\QT{}_3\|\QT{}_1)\cup \ET{}_{31}\\
        &\hspace{-0.5cm}\overset{\ET{}_{31}\subseteq
      \ET{}_{32}}{\overset{\mathrm{und}}{\overset{\QT{}_1\subseteq
      \QT{}_2}{\subseteq}}} (\QT{}_3\|\QT{}_2) \cup \ET{}_{32}\\
        &\overset{\ref{satzQuiSemantik}~2.}{=} \QT{}_{32}.
    \end{aligned}$
  \end{itemize}
\end{proof}

Im nächsten Lemma soll eine Verfeinerungsrelation über guten Kommunikation im
Sinne von error- und ruhe-freier Kommunikation betrachtet werden.

\begin{lem}[Verfeinerung mit Ruhe-Zuständen]
  \label{lemQuiVerfeinerung}
  Gegeben sind zwei \EIO{}s $S_1$ und $S_2$ mit der gleichen Signatur. Wenn
  $U\|S_1\QBRel U\|S_2$ für alle Partner $U$ gilt, dann folgt daraus $S_1\QRel
  S_2$.
\end{lem}

\begin{proof}
  Da davon ausgegangen wird, dass $S_1$ und $S_2$ die gleiche Signatur haben,
  definiert man $I:=I_1=I_2$ und $O:=O_1=O_2$. Für jeden Partner $U$ gilt
  $I_U=O$ und $O_U=I$.\\
  Um zu zeigen, dass die Relation $S_1\QRel S_2$ gilt, müssen die
  folgenden Punkte nachweisen werden:
  \begin{itemize}
    \item $S_1\ERel S_2$,
    \item $\QT{}(S_1)\subseteq \QT{}(S_2)$.
  \end{itemize}
  In Lemma~\ref{lemVerfeinerung} wurde bereits etwas ähnliche gezeigt, jedoch
  wurde dort als Voraussetzung $U\|S_1\EBRel U\|S_2$ für alle Partner $U$
  verwendet und hier die selbe Aussage mit der Basisrelation der Ruhe. Dadurch,
  dass die hier verwendete Basisrelation nichts über die Art der erreichbaren
  Fehlers in den Komponenten aussagt, kann der Beweis aus~\ref{lemVerfeinerung}
  nicht verwendet werden. Es kann also aus der lokalen Erreichbarkeit eines
  Errors in $S_1'$ und dem relationalen Zusammenhang von $S_1'\QBRel S_2'$ nur
  geschlossen werden, dass in $S_2'$ auch ein Fehler lokal erreichbar ist,
  jedoch kann dieser Fehler ein Error oder ein Ruhe-Zustand sein. Analog
  verhält es sich, wenn in $S_1'$ ein Ruhe-Zustand lokal erreichbar ist.\\
  Es muss also für den ersten Punkt folgendes nachgewiesen werden:
  \begin{itemize}
    \item $\ET{}(S_1)\subseteq \ET{}(S_2)$,
    \item $\EL{}(S_1)\subseteq \EL{}(S_2)$.
  \end{itemize}
  Es wird nur damit begonnen der ersten Unterpunkt des ersten Beweispunktes zu
  zeigen, d.h.\ es wird unter der Voraussetzung, dass $U\|S_1\QBRel U\|S_2$
  gilt gezeigt, dass $\ET{}_1\subseteq \ET{}_2$ gilt. Da beide \ET{}-Mengen
  unter \cont{} abgeschlossen sind, reicht es ein präfix-minimales Element
  $w\in\ET{}_1$ zu betrachten und zu zeigen, dass dieses $w$ oder eines seiner
  Präfixe in $\ET{}_2$ enthalten ist.
  \begin{itemize}
    \item Fall 1 ($w=\varepsilon$): Es handelt sich um einen lokal erreichbaren
      Error in $S_1$. Für $U$ wird ein Transitionssystem verwendet, das nur aus
      dem Startzustand, einer Schleife für alle Inputs $x\in I_U$ und einer
      Schleife für $\tau$ besteht. Somit kann $S_1$ die gleichen Error-Zustände
      lokal erreichen wie $U\|S_1$ und zusätzliche wurde durch die
      $\tau$-Schlinge sicher gestellt, dass in $U\|S_1$ kleine Ruhe-Zustände
      vorhanden sind. Es folgt also, dass in $U\|S_2$ ein Fehler lokal
      erreichbar ist. Es kann sich bei dem Fehler nur um einen Error handeln,
      da es in der Komposition mit $U$ keine Ruhe-Zustände geben kann. Da $U$
      keinen Error-Zustand und auch keine fehlenden Input-Möglichkeiten
      enthält, kann der Error nur von $S_2$ geerbt sein. Somit muss in $S_2$
      ein Error-Zustand lokal erreichbar sein, d.h.\ es gilt $\varepsilon\in
      \PrET{}(S_2)\subseteq \ET{}_2$.
    \item Fall 2 ($w=x_1\dots x_nx_{n+1}\in\Sigma ^+$ mit $n\geq 0$ und
      $x_{n+1}\in I$): Es wird der folgende Partner $U$ betrachtet (siehe auch
      Abbildung~\ref{UohneEmitTau}):
      \begin{itemize}
        \item $Q_U=\{q_0,q_1,\dots ,q_{n+1}\}$,
        \item $q_{0U}=q_0$,
        \item $E_U=\emptyset$,
        \item $\begin{aligned}[t]
            \delta _U=&\{(q_i,x_{i+1},q_{i+1})\mid  0\leq i\leq n\}\\
                      &\cup\{(q_i,x,q_{n+1})\mid  x\in I_U\backslash\{x_{i+1}\},
          0\leq i\leq n\}\\
          &\cup\{(q_{n+1},x,q_{n+1})\mid  x\in I_U\}\\
          &\cup\{(q_i,\tau,q_i)\mid 0\leq i\leq n+1\},
        \end{aligned}$
        \item $Qui_U = \emptyset$.
      \end{itemize}
      \begin{figure} [h!tbp]
      \begin{center}
        \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]
          \node (0) {$q_0$};
          \node (1) [right of=0] {$q_1$};
          \node (dots) [right of=1] {$\dots$};
          \node (n) [right of=dots] {$q_n$};
          \node (n1) at ($(1)!0.5!(dots) + (0,-3)$) {$q_{n+1}$};

          \path ($ (0) + (-1,0) $) edge (0)
                (0) edge node {$x_1$} (1)
                    edge [bend right] node [below, sloped] {$x?\neq x_1$} (n1)
                    edge [loop above] node {$\tau$} (0)
                (1) edge node {$x_2$} (dots)
                    edge node [below, sloped] {$x?\neq x_2$} (n1)
                    edge [loop above] node {$\tau$} (1)
                (dots) edge node {$x_n$} (n)
                       edge [dashed] (n1)
                (n) edge node [above, sloped] {$x?\in I_U$} (n1)
                    edge [bend left] node [sloped] {$x_{n+1}$!} (n1)
                    edge [loop above] node {$\tau$} (n)
                (n1) edge [loop below] node {$x?\in I_U, \tau$} (n1);
        \end{tikzpicture}
        \caption{$x?\neq x_i$ steht für alle $x\in I_U\backslash\{x_i\}$}
        \label{UohneEmitTau}
      \end{center}
      \end{figure}
      Da im Vergleiche zum Transitionssystem in Abbildung~\ref{UohneE} nur die
      $\tau$-Schlingen ergänzt wurden, ändert sich nichts an den Fällen 2a) und
      2b). Die Begründungen, wieso in den beiden Fällen $\varepsilon\in
      \PrET{}(U\|S_1)$ gilt bleibt also analog zum Beweis von
      Lemma~\ref{lemVerfeinerung}. Durch die $\tau$-Schlingen wurde, genau wie
      im letzten Fall, nur erreicht, dass in einer Parallelkomposition mit $U$
      keine Ruhe-Zustände möglich sind. Es kann also auch hier aus der lokalen
      Erreichbarkeit eines Error-Zustandes in $U\|S_1$ auf die lokale
      Erreichbarkeit eines Errors in $U\|S_2$ geschlossen werden. Die weitere
      Argumentation verläuft dann analog zu Fall 2 der selben Inklusion im
      Beweis zu Lemma~\ref{lemVerfeinerung}. Da $\tau$s nur interne Aktionen
      eines einzelnen Systems sind, verändert sich auch nichts an den Traces,
      über die argumentiert wird. Es können zwar möglicherweise $\tau$
      Transitionen ausgeführt werden, die können jedoch weder zu einem Fehler
      führen noch beeinflussen, dass ein anderer Trace nicht ausgeführt werden
      kann.
  \end{itemize}

  Nun wird mit dem zweiten Unterpunkt des ersten Beweispunktes begonnen. Genau
  wie im Beweis zu~\ref{lemVerfeinerung} ist hier jedoch auf Grund des bereits
  geführten Beweisteils nur noch $L(S_1)\backslash \ET{}(S_1)\subseteq
  \EL{}(S_2)$ zu zeigen. Es wird also für ein beliebig gewähltes $w\in
  L(S_1)\backslash \ET{}(S_1)$ gezeigt, dass es auch in $\EL{}(S_2)$ enthalten
  ist.
  \begin{itemize}
    \item Fall 1 ($w=\varepsilon$): Ebenso wie in~\ref{lemVerfeinerung} gilt
      auch hier, dass $\varepsilon$ immer in $\EL{}(S_2)$ enthalten ist.
    \item Fall 2 ($w=x_1\dots x_n$ mit $n\geq 1$): Die Konstruktion des
      Partners $U$ weicht wie im letzten Beweisteil nur durch die
      $\tau$-Schleifen an den Zuständen des Transitionssystems vom Beweis zu
      Lemma~\ref{lemVerfeinerung} ab. Somit ist der Partner $U$ dann wie folgt
      definiert (siehe dazu auch Abbildung~\ref{UmitEundTau}):
      \begin{itemize}
        \item $Q_U=\{q,q_0,q_1,\dots ,q_n\}$,
        \item $q_{0U}=q_0$,
        \item $E_U=\{q_n\}$,
        \item $\begin{aligned}[t]
            \delta _U=&\{(q_i,x_{i+1},q_{i+1})\mid 0\leq i< n\}\\
                      &\cup\{(q_i,x,q)\mid x\in I_U\backslash\{x_{i+1}\},0\leq
          i\leq n\}\\
          &\cup\{(q,x,q)\mid x\in I_U\}\\
          &\cup\{(q_i,\tau ,q_i)\mid 0\leq i\leq n\}\\
          &\cup\{(q,\tau ,q)\},
              \end{aligned}$
        \item $Qui_U =\emptyset$.
      \end{itemize}
      \begin{figure} [h!tbp]
      \begin{center}
        \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]

          \node (0) {$q_0$};
          \node (1) [right of=0] {$q_1$};
          \node (dots) [right of=1] {$\dots$};
          \node (n1) [right of=dots] {$q_{n-1}$};
          \node (n) [right of=n1, rectangle, draw] {$q_n\in E_U$};
          \node (q) at ($(1)!0.5!(dots) + (0,-3)$) {$q$};

          \path ($ (0) + (-1,0) $) edge (0)
                (0) edge node {$x_1$} (1)
                    edge [bend right] node [below, sloped] {$x?\neq x_1$} (q)
                    edge [loop above] node {$\tau$} (0)
                (1) edge node {$x_2$} (dots)
                    edge node [below, sloped] {$x?\neq x_2$} (q)
                    edge [loop above] node {$\tau$} (1)
                (dots) edge node {$x_{n-1}$} (n1)
                       edge [dashed] (q)
                (n1) edge node {$x_n$} (n)
                     edge [bend left] node [below, sloped] {$x?\neq x_n$} (q)
                     edge [loop above] node {$\tau$} (n1)
                (q) edge [loop below] node {$x?\in I_U, \tau$} (q)
                (n) edge [loop above] node {$\tau$} (n);
        \end{tikzpicture}
        \caption{$x?\neq x_i$ steht für alle $x\in I_U\backslash\{x_i\}$, $q_n$
          ist der einzige Error-Zustand}
        \label{UmitEundTau}
      \end{center}
      \end{figure}
      Da durch die $\tau$-Schlingen an den Zuständen wie oben vermieden wird,
      dass es in einer Komposition mit $U$ Ruhe-Zustände gibt, verläuft der Rest
      des Beweises dieses Punktes analog zum Beweis von
      Lemma~\ref{lemVerfeinerung}. Und somit gilt für alle Fälle (2a) bis 2d)),
      dass $w$ in $\EL{}(S_2)$ enthalten ist.
  \end{itemize}

  So bleibt nun nur noch der letzte Beweispunkt zu zeigen, d.h.\ die Inklusion
  $\QT{}_1\subseteq \QT{}_2$. Diese Inklusion kann jedoch noch anlog zum Beweis
  der Inklusion der error-gefluteten Sprachen weiter einschränken.
  Da bereits bekannt ist, dass $\ET{}_1\subseteq\ET{}_2$ gilt, muss nur
  noch $\StQT{}_1\backslash \ET{}(S_1)\subseteq \QT{}_2$ gezeigt werden.\\
  Es wird ein $w\in \StQT{}(S_1)\backslash\ET{}(S_1)$ gewählt und gezeigt, dass
  es auch in $\QT{}(S_2)$ enthalten ist.\\
  Es ist vom Startzustand von $S_1$ durch das Wort $w$ ein ruhiger Zustand
  erreichbar. Dies hätte keine Auswirkungen auf die Parallelkomposition
  $U\|S_1$, wenn in $U$ kein Ruhe-Zustand durch $w$ erreicht wäre.
  \begin{itemize} %TODO Input-Schleifen entfernen, da sonst durch
      %Synchronisation von dem gewollten Zustand in U||S2 weggelaufen werden kann
    \item Fall 1 ($w=\varepsilon$): Es ist ein Ruhe-Zustand lokal erreichbar in
      $S_1$, da jedoch $\varepsilon\notin \ET{}(S_1)$ gilt, ist kein Error
      lokal erreichbar. Für $U$ wird ein Transitionssystem verwendet, das nur
      aus dem Startzustand und einer Schleife für alle Inputs $x\in I_U$
      besteht. Somit ist auch in $U$ ein Ruhe-Zustand lokal erreichbar. Es
      folgt also mit Lemma~\ref{lemRuheParallelkomp}, dass auch in $U\|S_1$ ein
      Ruhe-Zustand lokal erreichbar ist und kein Error lokal erreicht werden
      kann, da keiner geerbt werden kann und durch die Transitionsmöglichkeiten
      von $U$ auch kein neuer Error entstehen kann. Es muss also auch in
      $U\|S_2$ ein Fehler lokal erreichbar sein. Bei diesem Fehler kann es sich
      nun um einen Error oder um einen Ruhe-Zustand handeln, dies ist jedoch
      Aufgrund der Definition der Menge \QT{} nicht relevant. Somit folgt in
      beiden Fällen, dass $w$ in $\QT{}(S_2)$ enthalten ist.
    \item Fall 2 ($w=x_1\dots x_n\in \Sigma ^+$ mit $n\geq 1$): Es wird der
      folgende Partner $U$ betrachtet (siehe auch Abbildung~\ref{UohneEmitI}):
      \begin{itemize}
        \item $Q_U=\{q_0,q_1,\dots ,q_n\}$,
        \item $q_{0U}=q_0$,
        \item $E_U=\emptyset$,
        \item $\begin{aligned}[t]
            \delta _U=&\{(q_i,x_{i+1},q_{i+1})\mid  0\leq i< n\}\\
                      &\cup\{(q_i,x,q_i)\mid  x\in (I_U\cup
          \{\tau\})\backslash\{x_{i+1}\}, 0\leq i< n\}\\
          &\cup\{(q_n,x,q_n)\mid  x\in I_U\},
        \end{aligned}$
        \item $Qui_U=\{q_n\}$.
      \end{itemize}
      \begin{figure} [h!tbp]
      \begin{center}
        \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]
          \node (0) {$q_0$};
          \node (1) [right of=0] {$q_1$};
          \node (dots) [right of=1] {$\dots$};
          \node (n) [right of=dots] {$q_n$};

          \path ($ (0) + (-1,0) $) edge (0)
                (0) edge node {$x_1$} (1)
                    edge [loop above] node {$x?\neq x_1, \tau$} (0)
                (1) edge node {$x_2$} (dots)
                    edge [loop above] node {$x?\neq x_2, \tau$} (1)
                (dots) edge node {$x_n$} (n)
                (n) edge [loop above] node {$x?\in I_U$} (n);
        \end{tikzpicture}
        \caption{$x?\neq x_i$ steht für alle $x\in I_U\backslash\{x_i\}$}
        \label{UohneEmitI}
      \end{center}
      \end{figure}
      Es gilt somit, dass auch in der Parallelkomposition $U\|S_1$ ein
      Ruhe-Zustand mit $w$ erreicht wird. Da es sich bei allen in $w$
      befindlichen Aktionen um synchronisierte Aktionen handelt und $I_U\cap
      I=\emptyset$, gilt $w\in O_{U\|S_1}^*$ und $w\in \StQT{}(U\|S_1)$. Es
      kann also in der Parallelkomposition durch $w$ ein Ruhe-Zustand lokal
      erreicht werden. Da $w\neq \ET{}(S_1)$ gilt, kann auf dem Weg, der mit
      $w$ im Transitionssystem $S_1$ zurück gelegt wird kein Error lokal
      erreicht werden. Es kann also weder von $S_1$ noch von $U$ ein Error auf
      diesem Weg geerbt werden und durch den Aufbau von $U$ wird auch
      verhindert, dass auf dem Weg ein neuer Error entsteht. Es gilt also sogar
      $w\in \StQT{}(U\|S_1)\backslash \ET{}(U\|S_1)$. Somit muss auch ein
      Fehler in $U\|S_2$ lokal erreichbar sein. Hier kann jedoch zunächst keine
      Aussage darüber getroffen werden, ob das $w$ ausführbar ist und ob es
      sich bei dem Fehler um Ruhe oder Error handelt.
      \begin{itemize}
        \item Fall 2a) ($\varepsilon\in \ET{}(U\|S_2)$): Es handelt sich bei
          dem lokal erreichbaren Fehler um einen Error. Es ist somit egal, ob
          das $w$ ausführbar ist. Der Error kann sowohl von $S_2$ geerbt sein,
          wie auch durch fehlende synchronizations Möglichkeiten als neuer
          Error in der Parallelkomposition entstanden sein. Es gilt also, dass
          bereits in $S_2$ ein Präfix von $w$ in $\ET{}_2$ enthalten ist, wegen
          des Beweises des ersten Punktes aus Lemma~\ref{lemVerfeinerung}. Da
          die Menge \ET{} unter \cont{} abgeschlossen ist, gilt also auch $w\in
          \ET{}(S_2)\subseteq \QT{}(S_2)$.
        \item Fall 2b) (Ruhe-Zustand lokal erreichbar in $U\|S_2$): Da in $U$
          nur durch $w$ ein ruhiger Zustand erreicht werden kann, muss es sich
          bei dem lokal erreichbaren Ruhe-Zustand in $U\|S_2$ um einen handeln,
          der mit $w$ erreicht werden kann. Mit Lemma~\ref{lemRuheParallelkomp}
          kann somit gefolgert werden, dass auch in $S_2$ ein Ruhe-Zustand mit
          $w$ erreichbar sein muss. Es gilt also $w\in \StQT{}(S_2)\subseteq
          \QT{}(S_2)$.
      \end{itemize}
  \end{itemize}
\end{proof}

Mit dem folgenden Satz wird festgehalten, dass mit \QRel{} die gröbste
Präkongruenz charakterisiert wurde bezüglich $\cdot\|\cdot$ die in \QBRel{}
enthalten ist.

\begin{satz}[Full Abstractness für Ruhe-Semantik]
  \label{satzQuiFullAbst}
  Seien $S_1$ und $S_2$ zwei \EIO{}s mit derselben Signatur. Dann gilt
  $S_1\QCRel S_2\Leftrightarrow S_1\QRel S_2$, insbesondere ist \QRel{} eine
  Präkongruenz.
\end{satz}

\begin{proof}
  \glqq{}$\Leftarrow$\grqq{}: Nach Definition gilt $w\in\QT{}(S)$ mit $w\in
  O^*$, genau dann wenn in $S$ ein Ruhe-Zustand oder ein Error-Zustand lokal
  erreichbar ist. $S_1\QRel S_2$ impliziert, dass $w\in\QT{}_2$ gilt, wenn
  $w\in\QT{}_1$ gilt. Somit ist ein Ruhe-Zustand oder ein Error-Zustand nur dann in
  $S_1$ lokal erreichbar, wenn auch ein solcher in $S_2$ lokal erreichbar ist.
  Daraus folgt, dass $S_1\QBRel S_2$ gilt. Somit ist \QRel{} in \QBRel{}
  enthalten. In Proposition~\ref{propQuiPrae} wurde festgestellt, dass \QRel{}
  eine Präkongruenz ist. Da jedoch \QCRel{} nach Definition die gröbste
  Präkongruenz bezüglich $\cdot\|\cdot$ ist, die in \QBRel{} enthalten ist,
  muss \QRel{} in \QCRel{} enthalten sein. Es folgt also aus $S_1\QRel S_2$,
  dass auch der relationale Zusammenhang $S_1\QCRel S_2$ gilt.

  \glqq{}$\Rightarrow$\grqq{}: Durch die Definition von \QCRel{} als
  Präkongruenz in~\ref{DefQuiBasisrel} folgt aus $S_1\QCRel{} S_2$, dass
  $U\|S_1\QCRel U\|S_2$ für alle EIOs $U$ gilt, die mit $S_1$ komponierbar sind.
  Somit folgt auch die Gültigkeit von $U\|S_1\EBRel U\|S_2$ für alle diese EIOs
  $U$. Mit Lemma~\ref{lemQuiVerfeinerung} folgt dann $S_1\QRel{} S_2$.
\end{proof}

Es wurde somit, wie im letzten Kapitel, eine Kette an Folgerungen gezeigt, die
sich zu einem Ring schließen. Dies ist in Abbildung~\ref{FolgerungsketteQui}
dargestellt.

\begin{figure}[h!tbp]
  \begin{center}
    \begin{tikzpicture}
      \matrix (m) [matrix of math nodes,row sep=2cm,column sep=4cm]{%
        S_1\QRel S_2 & S_1\QCRel S_2 \\
        \substack{\forall~\mathrm{Partner}~U:\\U\|S_1\QBRel U\|S_2} &
      \substack{\forall~\mathrm{komponierbaren}~U:\\U\|S_1\QBRel U\|S_2} \\};
        \draw[-implies, double, double distance=1mm]
          (m-1-1) -- node [above] {\glqq{}$\Leftarrow$\grqq{} von
            Satz~\ref{satzQuiFullAbst}} (m-1-2);
        \draw[-implies, double, double distance=1mm]
          (m-1-2) -- node [right] {Definition von \QCRel{}
          in~\ref{DefQuiBasisrel}} (m-2-2);
        \draw[-implies, double, double distance=1mm]
          (m-2-1) -- node [left]
          {Lemma~\ref{lemQuiVerfeinerung}} (m-1-1);
        \draw[-implies, double, double distance=1mm]
        (m-2-2) -- node [below]
        {$\substack{U~\mathrm{Partner}\\\Downarrow\\U~\mathrm{komponierbar}}$} (m-2-1);
    \end{tikzpicture}
    \caption{Folgerungskette}
    \label{FolgerungsketteQui}
  \end{center}
\end{figure}

Aus Satz~\ref{satzQuiFullAbst} und Lemma~\ref{lemQuiVerfeinerung} erhält man
das folgende Korollar. $S_1$ soll dabei $S_2$ verfeinern, genau dann wenn für
alle Partner \EIO{}s $U$ für die $S_2$ error- und ruhe-frei mit $U$
kommuniziert, folgt $S_1$ kommuniziert ebenfalls error- und ruhe-frei mit $U$.

\begin{kor}
  Es gilt: $S_1\QRel S_2\Leftrightarrow U\|S_1\QBRel U\|S_2$ für alle Partner
  $U$.
\end{kor}

\section{Hiding und Ruhe-Freiheit}

Es soll nun auch hier die Auswirkungen der Internalisierung von Aktionen auf
die Verfeinerungsrelationen untersucht werden. Es werden Outputs in interne
Aktionen umgewandelt. Da jedoch bei den Ruhe-Zuständen auch
$\tau$-Transitionen verboten wurden, verändert sich nichts an der Menge der
ruhigen Zustände. Da die Erreichbarkeit von Ruhe-Zuständen mittels lokaler
Aktionen betrachtet wurde, kann sich auch nichts an der Erreichbarkeit der
Ruhe-Zustände ändern. Somit kann eine analoge Proposition zu~\ref{propErBaIn}
zu formuliert werden.

\begin{prop}[Ruhe-Basisrelation bzgl. Internalisierung]
  Wenn $S_1\QBRel S_2$ gilt, dann folgt daraus, dass auch $S_1/X\QBRel S_2/X$
  gilt.
\end{prop}

\begin{proof}
  Dass die Error-Erreichbarkeit unverändert bleibt unter Hiding wurde bereits
  im Beweis zu Proposition~\ref{propErBaIn} gezeigt. Mit der analogen
  Argumentation folgt auch, dass sich nichts an der Erreichbarkeit der
  Ruhe-Zustände ändert. Es können durch Hiding nämlich nur Outputs verborgen
  werden, die bereits in der Menge der lokalen Aktionen enthalten sind. Die
  Menge der Ruhe-Zustände kann sich durch das Internalisieren auch nicht
  vergrößern oder verkleinern, wie oben bereits festgestellt.
\end{proof}

\begin{satz}[Ruhe-Präkongurenz bzgl. Internalisierung]
  \label{satzPraeInterQui}
  Seien $S_1$ und $S_2$ zwei \EIO{}s für die $S_1\QRel S_2$ gilt, somit gilt
  auch $S_1/X\QRel S_2/X$. Es ist also \QRel{} eine Präkongruenz bezüglich
  $\cdot /\cdot$.
\end{satz}

\begin{proof}
  Da $S_1\QRel S_2$ gilt, kann geschlossen werden, dass $S_1\ERel S_2$ und
  $\QT{}_1\subseteq \QT{}_2$ gilt. Aufgrund von
  Satz~\ref{satzPraeInternalisierung} ist bekannt, dass daraus $S_1/X\ERel
  S_2/X$ folgt.\\
  Es wird hier nun wie im Beweis zu Satz~\ref{satzPraeInternalisierung} erst
  einmal definiert, wie die neuen Ruhetraces nach dem Hiding aussehen:
  \begin{itemize}
    \item $\QT{}(S/X) = \{w\in (\Sigma\backslash (X\cap O))^*\mid \exists w'\in
      \QT{}(S):w'|_{\Sigma\backslash (X\cap O)}=w\}$.
  \end{itemize}
  Diese Definition stützt sich nur auf die bereits bekannte Menge $\QT{}(S)$.
  Es kann also zu jedem Ablauf des Systems ohne Hiding ein passender in dem
  System mit Hiding gefunden werden, falls die Definition korrekt ist.\\
  Die Korrektheit der Definition kann analog zum Beweis von
  Satz~\ref{satzPraeInternalisierung} gezeigt werden. Die Internalisierung hat
  also keine Auswirkung auf die Inklusion der Mengen. Es kann also aus der
  Gültigkeit von $\QT{}_1\subseteq \QT{}_2$ bzw.\ $\StQT{}_1\backslash
  \ET{}_1\subseteq \QT{}_2$ gefolgert werden, dass auch $\QT{}(S_1/X)\subseteq
  \QT{}(S_2/X)$ bzw.\ $\StQT{}(S_1/X)\backslash \ET{}(S_1/X)\subseteq
  \QT{}(S_2/X)$ gilt. Die Argumentation läuft dabei über die zweiten
  Inklusionen analog zu der Argumentation für die error-gefluteten Sprachen
  in~\ref{satzPraeInternalisierung}.\\
  Daraus folgt dann, dass die Relation \QRel{} trotz Hiding erhalten bleibt und
  somit bezüglich des Hiding diese Relation eine Präkongruenz ist.
\end{proof}

In Definition~\ref{defIntParal} wurde mit Hilfe des Internalisierungsoperator
aus der Parallelkomposition ohne Verbergen die Parallelkomposition mit
Verbergen der synchronisierten Aktionen nachgebildet. Es kann deren
Eigenschaft als Präkongruenz aus den Präkongruenz-Eigenschaften von
$\cdot\|\cdot$ und $\cdot /\cdot$ bezüglich \QRel{} aus der
Proposition~\ref{propQuiPrae} und dem Satz~\ref{satzPraeInterQui} geschlossen
werden.

\begin{kor}[Ruhe-Präkongruenz mit Internalisierung]
  \QRel{} ist eine Präkongruenz bezüglich $\cdot |\cdot$.
\end{kor}

\section{Diskussion für Veränderungen und weiterführende Definitionen}

% Es wäre hier auch denkbar, dass man für die Ruhe-Zustände einen andere Art
% der lokalen Erreichbarkeit verwendet. Es könnte dadurch sogar möglich sein eine
% noch gröbere Präkongruenz zu erhalten. Dies wurde hier jedoch nicht gemacht, da
% es bei den denkbaren Umsetzung eines solchen Erreichbarkeitsbegriffes zu
% Problemen kommt, so dass nicht mehr alle Inklusionen erreichen können, die in
% den Sätzen gefordert wurden.\\
% Die Umsetzung des lokalen Erreichbarkeitsbegriffes wie im letzten Kapitel, mit
% abschneiden der Outputs und beliebigem Fortsetzten der Traces, würde zu einem
% Problem in Satz~\ref{satzQuiSemantik} in Punkt 2.\ führen, dass analog zu dem
% Problem währe in der Semantik, die als nächstes beschrieben wird. Zusätzlich könnte
% man nicht die \EL{} als geflutete Sprache beibehalten sondern müsste noch
% zusätzlich mit den Ruhetraces fluten, da sonst nicht mehr alle
% Informationen, die in Ruhetraces enthalten auch in der gefluteten Sprache
% enthalten wäre. Durch diese Abänderung käme es zusätzlich noch zu einem Problem
% in Punkt 3.\ bei Satz~\ref{satzQuiSemantik}. Durch die Anwendung der Definition
% der gefluteten Sprachen würden Terme entstehen, in denen Ruhetraces und Traces
% aus der Sprache $L$ in Parallelkomposition gesetzt würden. Da die Ruhetraces
% nicht mehr Teil der Sprache sind, kann nicht mehr gelten, dass die Teil von
% $L_1\|L_2$ ist. Es kann auch nicht Teil der Ruhetraces sein, da Ruhetraces nur
% aus Kombination von zwei Ruhetraces entstehen können oder in dem sie
% Errortraces sind, was beides hier nicht der Fall ist.\\
% Man muss jedoch nicht an dieser Umsetzung für die lokale Erreichbarkeit
% festhalten. Man könnte sich auch eine Umsetzung denken, in der man die
% Ruhetraces zwar um die Outputs kürzt, jedoch dann nur Fortsetzungen zulässt,
% die bereits im Transitionssystem möglich sind. Somit benötigt man keine weitere
% Flutung der gefluteten Sprache \EL{}, da weiterhin alle Ruhetraces in der
% Sprache $L$ enthalten sind. Jedoch stößt man hier wieder bei Punkt 2.\ von
% Satz~\ref{satzQuiSemantik} an Probleme. Hierzu muss davon ausgegangen werden,
% dass eine neue \prune{}-Funktion definiert wurde bzw.\ eine neue
% \cont{}-Funktion, wie z.B. $\prunenew{}: \Sigma ^*\rightarrow
% \mathfrak{P}(\Sigma ^*), w\mapsto \{u\mid \exists v\in O^*:w=uv\}$. Somit würde
% sich die Definition der Ruhetraces entsprechend abändern. So das statt
% \StQT{} ein entsprechendes \PrQT{} enthalten wäre, dass durch die Anwendung
% der \prunenew{}-Funktion entstanden wäre. Somit wäre Punkte 2.\ von
% Satz~\ref{satzQuiSemantik} entsprechend auch leicht abgewandelt und müsste
% $\QT{}_{12}=\prunenew (\QT{}_1\|\QT{}_2)\cup \ET{}_{12}$ lauten. Das Problem
% würde nun auftauchen wenn man die Inklusionsrichtung $\supseteq$ zu beweisen
% versucht. Hierzu gibt es jedoch folgendes Gegenbeispiel, dass die Behauptung
% gar nicht stimmen kann.\\
% Für $S_1$ wird das folgende Transitionssystem verwendet (siehe dazu auch
% Abbildung~\ref{S1}):
% \begin{itemize}
%   \item $Q_1=\{q_{01}, q_{11}\}$,
%   \item $I_1=\emptyset$,
%   \item $O_1=\{a\}$,
%   \item $\delta _1 = \{(q_{01},a,q_{11})\}$,
%   \item $E_1=\emptyset$,
%   \item $Qui_1=\{q_{11}\}$.
% \end{itemize}
% \begin{figure} [h!tbp]
% \begin{center}
%   \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]

%     \node (0) {$q_{01}$};
%     \node (1) [right of=0, rectangle, draw] {$q_{11}\in Qui_1$};

%     \path (0) edge node {$a!$} (1);
%   \end{tikzpicture}
%   \caption{$S_1$}
%   \label{S1}
% \end{center}
% \end{figure}
% Für $S_2$ wird das folgende Transitionssystem verwendet (siehe dazu auch
% Abbildung~\ref{S2}):
% \begin{itemize}
%   \item $Q_2=\{q_{02}, q_{12}, q_{22}\}$,
%   \item $I_2=\{a\}$,
%   \item $O_2=\{b\}$,
%   \item $\delta _2 = \{(q_{02},a,q_{22}), (q_{02},b,q_{12}), (q_{12},a,q_{22}),
%     (q_{22},b,q_{22})\}$,
%   \item $E_2=\emptyset$,
%   \item $Qui_2=\{q_{12}\}$.
% \end{itemize}
% \begin{figure} [h!tbp]
% \begin{center}
%   \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]

%     \node (0) {$q_{02}$};
%     \node (1) [right of=0, rectangle, draw] {$q_{12}\in Qui_2$};
%     \node (2) at ($(0)!0.5!(1) + (0,-2)$){$q_{22}$};

%     \path (0) edge node {$b!$} (1)
%               edge [below left] node {$a?$} (2)
%           (1) edge node {$a?$} (2)
%           (2) edge [loop below] node {$b!$} (2);
%   \end{tikzpicture}
%   \caption{$S_2$}
%   \label{S2}
% \end{center}
% \end{figure}
% Somit ergibt sich für die Parallelkomposition $S_{12} = S_1\| S_2$ das folgende
% Transitionssystem, bei dem bereits unerreichbare Zustände weggelassen sind
% (siehe dazu auch Abbildung~\ref{S12}):
% \begin{itemize}
%   \item $Q_{12}=\{(q_{01},q_{02}), (q_{01},q_{12}), (q_{11},q_{22})\}$,
%   \item $I_{12}=\emptyset$,
%   \item $O_{12}=\{a,b\}$,
%   \item $\begin{aligned}[t]
%       \delta _{12} = \{&((q_{01},q_{02)},a,(q_{11},q_{22})),
%       ((q_{01},q_{12}),a,(q_{11},q_{22})),
%     ((q_{01},q_{02}),b,(q_{01},q_{12})),\\
%   &((q_{11},q_{22}),b,(q_{11},q_{22}))\},
%         \end{aligned}$
%   \item $E_{12}=\emptyset$,
%   \item $Qui_{12}=\emptyset$.
% \end{itemize}
% \begin{figure} [h!tbp]
% \begin{center}
%   \begin{tikzpicture}[->, >=latex',auto,node distance =3cm, semithick]

%     \node (0) {$(q_{01},q_{02})$};
%     \node (1) [right of=0] {$(q_{01},q_{12})$};
%     \node (2) at ($(0)!0.5!(1) + (0,-2)$){$(q_{11},q_{22})$};

%     \path (0) edge node {$b!$} (1)
%               edge [below left] node {$a!$} (2)
%           (1) edge node {$a!$} (2)
%           (2) edge [loop below] node {$b!$} (2);
%   \end{tikzpicture}
%   \caption{$S_{12}$}
%   \label{S12}
% \end{center}
% \end{figure}

% Es wäre möglich gewesen, die Menge der Ruhe-Zustände bereits anders zu
% definieren. Dadurch, dass die $\tau$-Transitionen verboten wurden, ist man
% einer Fallunterscheidung entgangen. Da jedoch Ruhe-Zustände als Deadlock-Zustände
% anzusehen sind, aus denen das System ohne Hilfe nicht mehr heraus kommt,
% müsste hier eigentlich darauf achten, wohin die $\tau$-Transitionen führen
% und dann möglicherweise die Zustände trotz dieser Transitionen in die Menge
% aufnehmen. Ein Zustand, der keine Outputs machen kann und als einzige
% $\tau$-Transition eine Schlinge auf sich selbst hat, kann sich ebenfalls nicht
% ohne Inputs aus diesem Zustand heraus bewegen. Dieser Zustand wird jedoch nach
% der Definition dieser Arbeit nicht als ruhig angesehen. Jedoch ist so ein Zustand
% divergent, da er eine unendliche Folge an internen Aktionen ausführen kann.
% Dies wurde in~\cite{Chilton2013} mit untersucht. Auch bei anderen
% Divergenz-Möglichkeiten eines Zustandes, bei denen nicht die Möglichkeit
% besteht von einem durch $\tau$ erreichbaren Zustand aus einen Output zu machen,
% sollte der Zustand als ruhig angesehen werden. Die passende Definition würde
% dann wie folgt lauten.

% \begin{Def}[Ruhe Alternative]
%   Ein Ruhe-Zustand ist ein Zustand in einem \EIO{}, der keine Möglichkeit hat
%   ohne einen Input von außen je wieder einen Output zu machen.\\
%   Somit ist die Menge der Ruhe-Zustände in einem \EIO{} wie folgt formal
%   definiert: $Qui:=\left\{q\in Q\mid \forall a\in O: q
%   \overset{a}{\not{\hspace{-0.1cm}\Rightarrow}}\right\}$.
% \end{Def}

% Diese Art der Definition hätte jedoch die Betrachtung deutlich aufwendiger
% gemacht und soll deshalb hier nicht behandelt werden.

Wie bereits oben erwähnt wurden in~\cite{Chilton2013} auch noch divergente
Zustände als Fehler-Zustände betrachtet. Um zu klären, was darunter verstanden
wird, wird nun noch eine Definition für Divergenz gegeben.
% Ruhe-Zustände wurden
% hier wie eine Verklemmung betrachtet. Analog dazu kann man divergente Zustände,
% die keine Möglichkeiten für andere Transitionsfolgen wie $\tau$ haben,
% als Livelocks auffassen. Es ist zwar die ganze Zeit möglich Aktionen
% auszuführen, aber nur interne, so dass keine Kommunikation mit anderen Systemen
% möglich ist.

\begin{Def}[Divergenz]
  Ein \emph{Divergenz-Zustand} ist ein Zustand in einem \EIO{}, der eine
  unendliche Folge an $\tau$s ausführen kann.
\end{Def}

\scriptsize\textcolor{lgray}{TODO: Erweiterungsmöglichkeiten:
\begin{itemize}
  \item Ruhe-Semantik analog zu Error-Semantik (\EL{} würde nicht mehr alle
    Informationen enthalten)
  \item Ruhe-Semantik mit \prune{} jedoch nur Traces Fortsetzungen wie im System
    möglich (\ref{satzQuiSemantik} 2. $\supseteq$ wegen fortsetzen mit Outputs
    und Synchronisation nicht mehr möglich)
  \item alternative Definition für Ruhe mit $\forall a\in O: q
    \overset{a}{\not{\hspace{-0.1cm}\Rightarrow}}$ (vor allem Veränderungen in
    Lemma 4.9, dort kann nicht mehr an Partner festgehalten werden, da die
    $\tau$-Schleifen dann nicht ausreichen, sondern ein Output aus der Menge
    der nicht synchronisierten Aktionen hinzugefügt werden muss)
\end{itemize}}

\normalsize
